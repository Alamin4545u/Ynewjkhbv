--- START OF FILE Paste February 20, 2026 - 1:06AM ---

<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BSKF - কুপ্তলা আলোকিত সমাজ ফাউন্ডেশন</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Certificate Generation Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>

    <style>
        body { font-family: 'Hind Siliguri', sans-serif; background: #f8fafc; color: #1e293b; }
        .glass-nav { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(0,0,0,0.05); }
        .premium-card { background: white; border-radius: 2.5rem; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.05); border: 1px solid rgba(255,255,255,0.7); transition: transform 0.3s ease; }
        .section-hide { display: none; }
        .btn-premium { background: linear-gradient(135deg, #10b981, #059669); color: white; box-shadow: 0 10px 20px rgba(16, 185, 129, 0.2); }
        
        /* --- Premium Certificate Styles --- */
        #certificateTemplate {
            width: 1000px; height: 700px; padding: 0; background: #fff; position: fixed; left: -9999px;
            font-family: 'Hind Siliguri', sans-serif; overflow: hidden; color: #1a2e35;
        }
        .cert-border-outer { height: 100%; width: 100%; padding: 30px; background: #065f46; box-sizing: border-box; position: relative; }
        .cert-border-inner { height: 100%; width: 100%; background: white; border: 5px double #fbbf24; box-sizing: border-box; padding: 50px; position: relative; display: flex; flex-direction: column; align-items: center; text-align: center; }
        
        .cert-bg-pattern { position: absolute; top:0; left:0; width:100%; height:100%; opacity: 0.05; pointer-events: none; background-image: url('https://www.transparenttextures.com/patterns/cubes.png'); }
        
        .cert-header { margin-bottom: 20px; }
        .cert-title { font-size: 55px; font-weight: 900; color: #065f46; letter-spacing: -1px; margin-bottom: 0; line-height: 1; text-transform: uppercase; }
        .cert-subtitle { font-size: 20px; font-weight: 700; color: #b45309; letter-spacing: 4px; margin-top: 5px; margin-bottom: 30px; }
        
        .cert-main-text { font-size: 22px; color: #475569; margin-bottom: 10px; font-style: italic; }
        .cert-user-name { font-size: 48px; font-weight: 800; color: #1e293b; border-bottom: 3px solid #065f46; padding-bottom: 5px; margin-bottom: 20px; min-width: 400px; display: inline-block; }
        .cert-body-text { font-size: 18px; line-height: 1.6; color: #334155; max-width: 700px; margin: 0 auto; }
        
        .cert-footer { width: 100%; display: flex; justify-content: space-between; align-items: flex-end; margin-top: auto; padding: 0 40px; }
        .sig-block { text-align: center; width: 180px; }
        .sig-line { border-top: 2px solid #94a3b8; margin-bottom: 8px; }
        .sig-text { font-size: 12px; font-weight: 900; color: #64748b; text-transform: uppercase; }
        
        .cert-seal { width: 140px; opacity: 0.9; margin-bottom: -20px; }
        .cert-id-badge { position: absolute; top: 40px; right: 40px; background: #fef3c7; border: 1px solid #f59e0b; padding: 8px 15px; border-radius: 8px; font-weight: 900; font-size: 14px; color: #b45309; transform: rotate(5deg); }
        /* ---------------------------------- */
        
        @keyframes marquee { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
        .animate-marquee { animation: marquee 30s linear infinite; }
    </style>
</head>
<body>

    <!-- Navbar -->
    <nav class="sticky top-0 z-50 glass-nav px-6 py-4 flex justify-between items-center">
        <div class="flex items-center gap-2 cursor-pointer" onclick="showSection('home')">
            <div class="bg-green-600 p-2 rounded-2xl shadow-lg"><i data-lucide="shield-check" class="text-white w-5 h-5"></i></div>
            <span class="text-xl font-black italic tracking-tighter">BSKF.</span>
        </div>
        <div class="relative">
            <button id="profileBtn" class="bg-white border-2 border-slate-100 p-2 rounded-2xl shadow-sm hover:border-green-500 transition">
                <i data-lucide="user" class="w-6 h-6 text-slate-600"></i>
            </button>
            <div id="profileMenu" class="hidden absolute right-0 mt-3 w-56 bg-white rounded-3xl shadow-2xl border p-2 z-50 overflow-hidden">
                <div id="guestLinks" class="space-y-1">
                    <button onclick="showSection('login')" class="w-full text-left px-5 py-3 hover:bg-slate-50 rounded-2xl font-bold text-sm">লগইন</button>
                    <button onclick="showSection('register')" class="w-full text-left px-5 py-3 hover:bg-green-50 rounded-2xl font-bold text-sm text-green-600">নিবন্ধন</button>
                </div>
                <div id="userLinks" class="hidden space-y-1">
                    <button onclick="showSection('dashboard')" class="w-full text-left px-5 py-3 hover:bg-slate-50 rounded-2xl font-bold text-sm">ড্যাশবোর্ড</button>
                    <button onclick="logout()" class="w-full text-left px-5 py-3 hover:bg-red-50 text-red-600 rounded-2xl font-bold text-sm mt-1 border-t pt-4">লগআউট</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto p-6 space-y-10">
        
        <!-- Home Section -->
        <section id="home">
            <header class="text-center py-10 space-y-4">
                <h1 class="text-5xl md:text-7xl font-black tracking-tighter italic uppercase">BSKF <span class="text-green-600">Foundation</span></h1>
                <p class="text-slate-500 italic font-bold">কুপ্তলা আলোকিত সমাজ গঠনে আমাদের ঐকান্তিক পথচলা।</p>
            </header>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
                <div class="premium-card p-8 border-t-8 border-green-500">
                    <p class="text-[10px] font-black text-slate-400 uppercase tracking-widest">মোট ফান্ড</p>
                    <h3 id="statFund" class="text-3xl font-black">৳ ০</h3>
                </div>
                <div class="premium-card p-8 border-t-8 border-red-500">
                    <p class="text-[10px] font-black text-slate-400 uppercase tracking-widest">মোট ব্যয়</p>
                    <h3 id="statExpense" class="text-3xl font-black">৳ ০</h3>
                </div>
                <div class="premium-card p-8 border-t-8 border-blue-500">
                    <p class="text-[10px] font-black text-slate-400 uppercase tracking-widest">সদস্যবৃন্দ</p>
                    <h3 id="statMembers" class="text-3xl font-black">০ জন</h3>
                </div>
            </div>

            <div class="bg-slate-900 py-4 rounded-3xl overflow-hidden shadow-2xl mb-10">
                <div id="ticker" class="flex gap-20 animate-marquee whitespace-nowrap text-white text-[10px] font-bold italic uppercase tracking-widest"></div>
            </div>

            <div class="premium-card p-8 overflow-hidden mb-12">
                <h4 class="text-lg font-black mb-6 flex items-center gap-2 italic"><i data-lucide="receipt"></i> অর্থ ব্যয়ের পূর্ণ হিসাব</h4>
                <div class="overflow-x-auto"><table class="w-full text-sm text-left"><tbody id="homeExpList" class="font-bold divide-y divide-slate-50"></tbody></table></div>
            </div>
        </section>

        <!-- Register Section -->
        <section id="register" class="section-hide max-w-xl mx-auto">
            <div class="premium-card p-10 border-t-8 border-green-600">
                <h2 class="text-2xl font-black mb-2 text-center italic">সদস্য নিবন্ধন</h2>
                <p class="text-center text-red-500 text-xs font-black mb-8 italic">নিবন্ধন ফি ২০০ টাকা প্রদান করে ফরমটি পূরণ করুন।</p>
                <form id="regForm" class="space-y-4">
                    <input type="text" id="regName" placeholder="পুরো নাম" class="w-full p-4 bg-slate-50 rounded-2xl border outline-none font-bold" required>
                    <input type="text" id="regPhone" placeholder="মোবাইল নম্বর" class="w-full p-4 bg-slate-50 rounded-2xl border outline-none font-bold" required>
                    <input type="text" id="regNID" placeholder="এনআইডি নম্বর" class="w-full p-4 bg-slate-50 rounded-2xl border outline-none font-bold" required>
                    <input type="password" id="regPass" placeholder="পাসওয়ার্ড তৈরি করুন" class="w-full p-4 bg-slate-50 rounded-2xl border outline-none font-bold" required>
                    
                    <div class="bg-green-50 p-6 rounded-[2rem] border-2 border-dashed border-green-200 space-y-4">
                        <h4 class="text-center font-black text-green-700 text-sm italic">নিচের নম্বরে ফি পাঠিয়ে TrxID দিন</h4>
                        <div class="pay-numbers flex flex-wrap justify-center gap-4 text-[10px] font-black text-slate-600 uppercase italic">
                            <!-- JS Will Load Here -->
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <select id="regMethod" class="p-4 bg-white rounded-xl border font-bold text-sm" required>
                                <option value="">মেথড</option><option value="Bkash">Bkash</option><option value="Nagad">Nagad</option><option value="Rocket">Rocket</option>
                            </select>
                            <input type="text" id="regSender" placeholder="প্রেরক নম্বর" class="p-4 bg-white rounded-xl border font-bold text-sm" required>
                        </div>
                        <input type="text" id="regTrx" placeholder="Transaction ID (TrxID)" class="w-full p-4 bg-white rounded-xl border-2 border-green-300 font-black text-center uppercase tracking-widest" required>
                    </div>
                    <button type="submit" class="w-full btn-premium py-5 rounded-2xl font-black text-lg shadow-xl uppercase italic">Apply For Membership</button>
                </form>
            </div>
        </section>

        <!-- Dashboard Section -->
        <section id="dashboard" class="section-hide space-y-8">
            <div id="pendingStatus" class="hidden bg-yellow-50 border-2 border-dashed border-yellow-200 p-10 rounded-[3rem] text-center">
                <i data-lucide="clock" class="w-12 h-12 text-yellow-500 mx-auto mb-4"></i>
                <h3 class="text-xl font-black text-yellow-700 italic">আপনার আবেদনটি অপেক্ষমান!</h3>
                <p class="text-xs font-bold text-slate-500 mt-2 italic">এডমিন আপনার পেমেন্ট ২০০ টাকা যাচাই করার পর আইডি সক্রিয় হবে।</p>
            </div>

            <div id="activeDashboard" class="hidden space-y-10">
                <div class="premium-card p-12 text-center relative overflow-hidden border-t-8 border-green-500">
                    <div class="bg-green-500 text-white absolute top-8 right-8 px-4 py-1 rounded-full text-[10px] font-black italic shadow-lg">VERIFIED MEMBER</div>
                    <h4 id="dashName" class="text-4xl font-black text-slate-900 mb-1 tracking-tight italic uppercase">...</h4>
                    <p id="dashID" class="text-[10px] text-slate-400 font-black tracking-[0.3em] uppercase mb-10">ID: BSKF-0000</p>
                    <div class="grid grid-cols-2 gap-4 text-left border-t pt-8 text-xs font-bold text-slate-500 italic">
                        <p>NID: <span id="dashNID" class="text-slate-900">...</span></p>
                        <p>Phone: <span id="dashPhone" class="text-slate-900">...</span></p>
                    </div>
                    
                    <button onclick="downloadCertificate()" class="mt-10 bg-slate-900 text-white px-8 py-3 rounded-2xl font-black text-[10px] uppercase tracking-widest flex items-center gap-2 mx-auto shadow-2xl transition hover:scale-105 active:scale-95">
                        <i data-lucide="award" class="w-4 h-4"></i> Download Premium Certificate
                    </button>
                </div>

                <div class="grid grid-cols-2 gap-6">
                    <button onclick="showSection('payment')" class="bg-slate-900 text-white p-8 rounded-[2.5rem] flex flex-col items-center gap-3 shadow-2xl font-black italic">
                        <i data-lucide="plus-circle" class="w-8 h-8 text-green-400"></i> অর্থ জমা দিন
                    </button>
                    <button onclick="showSection('history')" class="bg-white text-slate-900 p-8 rounded-[2.5rem] flex flex-col items-center gap-3 shadow-xl border font-black italic">
                        <i data-lucide="history" class="w-8 h-8 text-blue-500"></i> পেমেন্ট ইতিহাস
                    </button>
                </div>
            </div>
        </section>

        <!-- Payment Section -->
        <section id="payment" class="section-hide max-w-md mx-auto">
            <div class="premium-card p-10 border-t-8 border-green-600">
                <h3 class="text-xl font-black mb-8 italic uppercase tracking-tighter">মাসিক চাঁদা প্রদান</h3>
                <div class="pay-numbers bg-slate-900 text-white p-6 rounded-3xl mb-8 space-y-3 text-[11px] font-black italic uppercase text-green-400 border-2 border-dashed border-green-900">
                    <!-- Numbers will load here -->
                </div>
                <form id="payForm" class="space-y-4">
                    <select id="pMethod" class="w-full p-4 bg-slate-50 rounded-2xl border font-bold text-sm" required>
                        <option value="">মেথড</option><option value="Bkash">Bkash</option><option value="Nagad">Nagad</option><option value="Rocket">Rocket</option>
                    </select>
                    <input type="number" id="pAmt" placeholder="পরিমাণ" class="w-full p-4 bg-slate-50 rounded-2xl border font-bold" required>
                    <input type="text" id="pTrx" placeholder="Transaction ID (TrxID)" class="w-full p-4 bg-slate-50 rounded-2xl border font-black uppercase tracking-widest" required>
                    <input type="text" id="pFrom" placeholder="প্রেরক নম্বর" class="w-full p-4 bg-slate-50 rounded-2xl border font-bold" required>
                    <button type="submit" class="w-full btn-premium py-4 rounded-2xl font-black italic tracking-widest">CONFIRM PAYMENT</button>
                </form>
            </div>
        </section>

        <!-- History -->
        <section id="history" class="section-hide max-w-md mx-auto space-y-4 pb-20">
            <h3 class="text-xl font-black italic mb-6">আপনার পেমেন্ট রেকর্ড</h3>
            <div id="histList" class="space-y-3"></div>
        </section>

        <!-- PREMIUM CERTIFICATE TEMPLATE -->
        <div id="certificateTemplate">
            <div class="cert-border-outer">
                <div class="cert-border-inner">
                    <div class="cert-bg-pattern"></div>
                    <div class="cert-id-badge" id="certID">ID: BSKF-0000</div>
                    
                    <div class="cert-header">
                        <h1 class="cert-title">BSKF FOUNDATION</h1>
                        <p class="cert-subtitle">কুপ্তলা আলোকিত সমাজ ফাউন্ডেশন</p>
                    </div>
                    
                    <p class="cert-main-text">Membership Certification</p>
                    <p style="font-size: 14px; color: #64748b; margin-bottom: 5px;">This is to officially certify that</p>
                    
                    <div class="cert-user-name" id="certName">MEMBER NAME</div>
                    
                    <p class="cert-body-text">
                        has been recognized as an active and verified member of the <b>BSKF Foundation</b>. 
                        We honor their commitment to social welfare and the betterment of our community. 
                        Their participation helps us build a brighter and more illuminated society.
                    </p>
                    
                    <img src="https://i.ibb.co/L6V6X4V/official-seal.png" onerror="this.src='https://cdn-icons-png.flaticon.com/512/3670/3670209.png'" class="cert-seal">
                    
                    <div class="cert-footer">
                        <div class="sig-block">
                            <div class="sig-line"></div>
                            <p class="sig-text">Chairman</p>
                        </div>
                        <div style="text-align: center;">
                            <p style="font-size: 10px; font-weight: bold; color: #94a3b8; margin-bottom: 5px;">VERIFICATION SECURED</p>
                            <div style="width: 60px; height: 60px; background: #f1f5f9; margin: 0 auto; border: 2px solid #e2e8f0; display: flex; align-items: center; justify-content: center; border-radius: 8px;">
                                <i data-lucide="qr-code" class="text-slate-300 w-10 h-10"></i>
                            </div>
                        </div>
                        <div class="sig-block">
                            <div class="sig-line"></div>
                            <p class="sig-text">General Secretary</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Login -->
        <section id="login" class="section-hide max-w-sm mx-auto py-20">
            <div class="premium-card p-10 border-t-8 border-slate-900">
                <h2 class="text-2xl font-black mb-8 text-center italic uppercase">Member Login</h2>
                <form id="loginForm" class="space-y-4">
                    <input type="text" id="logPhone" placeholder="মোবাইল নম্বর" class="w-full p-4 bg-slate-50 rounded-2xl border font-bold" required>
                    <input type="password" id="logPass" placeholder="পাসওয়ার্ড" class="w-full p-4 bg-slate-50 rounded-2xl border font-bold" required>
                    <button type="submit" class="w-full bg-slate-900 text-white py-4 rounded-2xl font-black italic">LOGIN →</button>
                </form>
            </div>
        </section>

    </main>

    <script>
        const firebaseConfig = {
          apiKey: "AIzaSyDeFrZUu2ZwWzFa7owaC0v6WO_zP2lEJ1Q",
          authDomain: "firstdevloping.firebaseapp.com",
          projectId: "firstdevloping",
          storageBucket: "firstdevloping.firebasestorage.app",
          messagingSenderId: "197486624624",
          appId: "1:197486624624:web:2b7b055dc3ecbad20399b5"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
        lucide.createIcons();

        let activeUser = null;

        function showSection(id) {
            ['home', 'register', 'login', 'dashboard', 'payment', 'history'].forEach(s => {
                const el = document.getElementById(s); if(el) el.classList.add('section-hide');
            });
            document.getElementById(id).classList.remove('section-hide');
            document.getElementById('profileMenu').classList.add('hidden');
            window.scrollTo(0,0);
        }

        document.getElementById('profileBtn').onclick = (e) => { e.stopPropagation(); document.getElementById('profileMenu').classList.toggle('hidden'); }
        document.body.onclick = () => document.getElementById('profileMenu').classList.add('hidden');

        auth.onAuthStateChanged(async (user) => {
            if (user) {
                const phone = user.email.split('@')[0];
                db.collection("members").doc(phone).onSnapshot(doc => {
                    if(doc.exists) {
                        activeUser = doc.data();
                        updateDashboardUI();
                    }
                });
            } else {
                document.getElementById('guestLinks').classList.remove('hidden');
                document.getElementById('userLinks').classList.add('hidden');
                showSection('home');
            }
        });

        function updateDashboardUI() {
            document.getElementById('dashName').innerText = activeUser.name;
            document.getElementById('dashID').innerText = 'ID: BSKF-' + activeUser.id;
            document.getElementById('dashNID').innerText = activeUser.nid;
            document.getElementById('dashPhone').innerText = activeUser.phone;
            
            document.getElementById('certName').innerText = activeUser.name;
            document.getElementById('certID').innerText = 'ID: BSKF-' + activeUser.id;

            document.getElementById('guestLinks').classList.add('hidden');
            document.getElementById('userLinks').classList.remove('hidden');

            if(activeUser.status === 'pending') {
                document.getElementById('pendingStatus').classList.remove('hidden');
                document.getElementById('activeDashboard').classList.add('hidden');
            } else {
                document.getElementById('pendingStatus').classList.add('hidden');
                document.getElementById('activeDashboard').classList.remove('hidden');
                loadPersonalHistory(activeUser.phone);
            }
        }

        function initApp() {
            db.collection("stats").doc("summary").onSnapshot(doc => {
                if(doc.exists) {
                    const d = doc.data();
                    document.getElementById('statFund').innerText = '৳ ' + (d.fund || 0).toLocaleString('bn-BD');
                    document.getElementById('statExpense').innerText = '৳ ' + (d.expenses || 0).toLocaleString('bn-BD');
                }
            });

            db.collection("members").where("status", "==", "active").onSnapshot(snap => {
                document.getElementById('statMembers').innerText = snap.size + ' জন';
                const ticker = document.getElementById('ticker'); ticker.innerHTML = "";
                snap.forEach(m => ticker.innerHTML += `<span>★ ${m.data().name} (${m.data().role || 'সদস্য'})</span>`);
            });

            db.collection("expenses").onSnapshot(snap => {
                const list = document.getElementById('homeExpList'); list.innerHTML = "";
                let docs = []; snap.forEach(doc => docs.push(doc.data()));
                docs.sort((a,b) => (b.timestamp?.seconds || 0) - (a.timestamp?.seconds || 0)).slice(0, 10).forEach(e => {
                    list.innerHTML += `<tr class="border-b border-slate-50"><td class="py-4 px-2 uppercase">${e.desc}</td><td class="py-4 px-2 text-red-500 font-black italic">৳ ${e.amount}</td><td class="py-4 px-2 text-right opacity-30 text-[9px] font-black">${e.timestamp ? new Date(e.timestamp.toDate()).toLocaleDateString('bn-BD') : ''}</td></tr>`;
                });
            });

            db.collection("config").doc("payment_numbers").onSnapshot(doc => {
                if(doc.exists) {
                    const d = doc.data();
                    const numHTML = `<span>Bkash: ${d.bkash}</span> | <span>Nagad: ${d.nagad}</span> | <span>Rocket: ${d.rocket}</span>`;
                    const container = document.querySelectorAll('.pay-numbers');
                    container.forEach(el => el.innerHTML = numHTML);
                }
            });
        }

        function downloadCertificate() {
            const template = document.getElementById('certificateTemplate');
            const btn = event.currentTarget;
            btn.innerHTML = '<i data-lucide="loader" class="w-4 h-4 animate-spin"></i> Generating...';
            lucide.createIcons();
            
            html2canvas(template, {
                scale: 2, // High resolution
                useCORS: true,
                allowTaint: true
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `BSKF-Premium-Certificate-${activeUser.name}.png`;
                link.href = canvas.toDataURL("image/png");
                link.click();
                btn.innerHTML = '<i data-lucide="award" class="w-4 h-4"></i> Download Premium Certificate';
                lucide.createIcons();
            });
        }

        document.getElementById('regForm').onsubmit = async (e) => {
            e.preventDefault();
            const phone = document.getElementById('regPhone').value;
            try {
                await auth.createUserWithEmailAndPassword(phone + "@bskf.com", document.getElementById('regPass').value);
                const memberInfo = { name: document.getElementById('regName').value, phone, nid: document.getElementById('regNID').value, id: Math.floor(1000 + Math.random() * 9000), status: 'pending', role: 'member', reg_fee_trx: document.getElementById('regTrx').value };
                await db.collection("members").doc(phone).set(memberInfo);
                await db.collection("payments").add({ phone, name: memberInfo.name, amount: 200, method: document.getElementById('regMethod').value, trxId: document.getElementById('regTrx').value, from: document.getElementById('regSender').value, status: 'pending', type: 'registration', timestamp: firebase.firestore.FieldValue.serverTimestamp() });
                alert("আবেদন সফল হয়েছে!"); showSection('dashboard');
            } catch (err) { alert(err.message); }
        };

        document.getElementById('loginForm').onsubmit = async (e) => {
            e.preventDefault();
            try { await auth.signInWithEmailAndPassword(document.getElementById('logPhone').value + "@bskf.com", document.getElementById('logPass').value); showSection('dashboard'); }
            catch (err) { alert("ভুল তথ্য।"); }
        };

        document.getElementById('payForm').onsubmit = async (e) => {
            e.preventDefault();
            await db.collection("payments").add({ phone: activeUser.phone, name: activeUser.name, method: document.getElementById('pMethod').value, amount: parseFloat(document.getElementById('pAmt').value), trxId: document.getElementById('pTrx').value, from: document.getElementById('pFrom').value, status: 'pending', type: 'monthly', timestamp: firebase.firestore.FieldValue.serverTimestamp() });
            alert("পেমেন্ট তথ্য জমা হয়েছে!"); showSection('history'); e.target.reset();
        };

        function loadPersonalHistory(phone) {
            db.collection("payments").where("phone", "==", phone).onSnapshot(snap => {
                const list = document.getElementById('histList'); list.innerHTML = "";
                let personalDocs = []; snap.forEach(d => personalDocs.push(d.data()));
                personalDocs.sort((a,b) => (b.timestamp?.seconds || 0) - (a.timestamp?.seconds || 0)).forEach(p => {
                    const isOk = p.status === 'confirmed';
                    list.innerHTML += `<div class="bg-white p-5 rounded-3xl shadow-sm border flex justify-between items-center transition hover:shadow-md"><div><p class="text-xl font-black italic tracking-tighter">৳ ${p.amount}</p><p class="text-[8px] opacity-40 font-black uppercase">${p.method} | ${p.trxId}</p></div><span class="px-3 py-1 rounded-full text-[9px] font-black uppercase italic ${isOk ? 'bg-green-100 text-green-600' : 'bg-yellow-100 text-yellow-600'}">${isOk ? 'Approved' : 'Pending'}</span></div>`;
                });
            });
        }

        function logout() { auth.signOut(); location.reload(); }
        initApp();
    </script>
</body>
</html>
